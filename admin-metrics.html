<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Métricas | Bocaraca</title>

  <link rel="icon" href="./assets/favicon-32x32.png" type="image/x-icon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <script src="https://unpkg.com/lucide@latest"></script>

  <link rel="manifest" href="./manifest.webmanifest?v=2025.10.20.v1">
  <meta name="theme-color" content="#0d1117">

  <!-- iOS “Add to Home Screen” soporte -->
  <link rel="apple-touch-icon" href="./assets/android-chrome-512x512.png">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">


  <!-- Estilos existentes -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- Chart.js (gráficas) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* ===== MÉTRICAS – LAYOUT CENTRADO ===== */
  html,body{overflow-x:hidden}
  .metrics-wrap{
    max-width:1024px;
    margin:80px auto 24px;
    padding:0 16px;
    box-sizing:border-box;
  }
  h1{ text-align:center; margin:18px 0 6px; }
  .muted{ opacity:.75; font-size:12px; text-align:center; }

  /* ===== KPI CARDS – fuerza estilos sobre .card global ===== */
/* ===== MÉTRICAS (aislado) ===== */
.m-cards{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
  align-items:stretch;
  margin:14px 0 18px;
}
@media (min-width:560px){ .m-cards{ grid-template-columns:repeat(3,1fr); } }
@media (min-width:820px){ .m-cards{ grid-template-columns:repeat(4,1fr); } }

.m-card{
  --m-bg:#0f141a;
  background:
    radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.03), transparent 60%),
    var(--m-bg);
  border:1px solid rgba(255,255,255,.10);
  border-radius:16px;
  padding:16px 14px;
  box-shadow:
    0 10px 28px rgba(0,0,0,.30),
    inset 0 1px 0 rgba(255,255,255,.03);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:132px;           /* mismas alturas */
  text-align:center;
  transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.m-card:hover{
  transform: translateY(-2px);
  border-color: rgba(255,255,255,.16);
  box-shadow: 0 14px 36px rgba(0,0,0,.36);
}
.m-card > h4{
  margin:0 0 8px;
  font-size:12.5px;
  letter-spacing:.35px;
  font-weight:800;
  color:#9fb0c2;
  text-transform:uppercase;
}
.m-card > .big{
  font-size:28px;
  line-height:1;
  font-weight:900;
  color:#e9eef6;
  text-shadow:0 1px 0 rgba(255,255,255,.04);
}
.m-card > .muted{ margin-top:6px; opacity:.75; font-size:12px; }


  /* ===== GRÁFICAS ===== */
  .charts{
    display:grid;
    grid-template-columns:1fr;
    gap:16px;
    margin-top:6px;
  }
  @media (min-width:820px){
    .charts{ grid-template-columns:1fr 1fr; }
    .chart-full{ grid-column:1 / -1; }
  }
  .chart-card{
    background:#12171c !important;
    border:1px solid rgba(255,255,255,.10) !important;
    border-radius:16px !important;
    padding:16px !important;
    box-shadow:0 8px 26px rgba(0,0,0,.25);
    overflow:visible;
  }
  .chart-card h3{ margin:0 0 10px; font-size:17px; }
  .chart-card canvas{ width:100% !important; height:auto !important; display:block; }

  /* Badge del año */
  .pill{
    display:inline-block; padding:2px 10px; border-radius:999px;
    font-size:12px; margin-left:8px;
    background:#0e3a20; color:#c2ffd8; border:1px solid #1f8a4d;
  }
</style>


</head>
<body>
<!-- Botón hamburguesa -->
<button id="toggleNav" class="hamburger-btn" aria-label="Menú">
  <i class="bi bi-list"></i>
</button>

<nav id="sidebar" class="sidebar">
    <ul>
      <li><a href="./admin-dashboard.html"><i class="bi bi-house-fill"></i> Inicio</a></li>
      <li><a href="./usuarios.html"><i class="bi bi-people-fill"></i> Usuarios</a></li>
      <li><a href="./control-mensualidades.html"><i class="bi bi-cash-coin"></i> Mensualidades</a></li>
      <li><a href="./admin-users.html"><i class="bi bi-person-rolodex"></i></i> Roles</a></li>
      <li><a href="./reportes.html"><i class="bi bi-file-earmark-text-fill"></i> Reportes</a></li>
      <li><a href="./admin-metrics.html"><i class="bi bi-pie-chart-fill"></i></i> Metricas</a></li>
      <li><a href="#" id="logoutSidebar"><i class="bi bi-box-arrow-right"></i> Cerrar sesión</a></li>
    </ul>
</nav>

  <main class="metrics-wrap">
    <h1 style="text-align:center;margin:18px 0 12px;">Panel de métricas</h1>
    <p class="muted" id="lastUpdate" style="text-align:center;"></p>

    <!-- Tarjetas (aisladas) -->
    <section class="m-cards" id="cards">
      <div class="m-card"><h4>Usuarios totales</h4><div class="big" id="kpiTotal">—</div></div>
      <div class="m-card"><h4>Activos</h4><div class="big" id="kpiActivos">—</div></div>
      <div class="m-card"><h4>Inactivos</h4><div class="big" id="kpiInactivos">—</div></div>
      <div class="m-card"><h4>Permanencia promedio</h4><div class="big" id="kpiPermanencia">—</div><div class="muted">en meses</div></div>

      <div class="m-card"><h4>Admins</h4><div class="big" id="kpiAdmins">—</div></div>
      <div class="m-card"><h4>Profesores</h4><div class="big" id="kpiProfes">—</div></div>
      <div class="m-card"><h4>Estudiantes</h4><div class="big" id="kpiStudents">—</div></div>
      <div class="m-card"><h4>Usuarios nuevos 30 días</h4><div class="big" id="kpiNuevos">—</div></div>
    </section>


    <!-- Gráficas -->
    <section class="charts">
      <div class="chart-card">
        <h3>Altas por mes <span class="pill" id="yearBadge"></span></h3>
        <canvas id="signupChart" height="180"></canvas>
      </div>

      <div class="chart-card">
        <h3>Género</h3>
        <canvas id="genderChart" height="180"></canvas>
        <div class="muted" id="genderNote"></div>
      </div>

      <div class="chart-card chart-full">
        <h3>Edades</h3>
        <canvas id="ageChart" height="200"></canvas>
        <div class="muted" id="ageNote"></div>
      </div>
    </section>
  </main>

  <!-- Scripts Firebase (tu patrón de módulos) -->
  <script type="module" src="./js/admin-metrics.js"></script>

  <footer>
      <p>© 2025 <a href="https://github.com/luisillo1cr" target="_blank">luisillo1cr</a>. Todos los derechos reservados.</p>
  </footer>

  <script type="module" src="./js/sw-register.js"></script>

</body>
</html>
